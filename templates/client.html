<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CleanSweep Dashboard</title>
<style>
body { margin: 0; font-family: "Poppins", sans-serif; background: linear-gradient(135deg, #a5d6a7, #4db6ac); color: #00332d; min-height: 100vh; display: flex; }
/* Sidebar */
.sidebar { width: 220px; background: white; border-right: 3px solid #a5d6a7; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
.sidebar h2 { color: #004d40; text-align: center; margin-bottom: 20px; }
.sidebar button { background: none; border: none; padding: 10px; border-radius: 8px; cursor: pointer; text-align: left; font-size: 15px; color: #004d40; transition: all 0.3s; }
.sidebar button:hover, .sidebar button.active { background: #b2dfdb; font-weight: bold; transform: scale(1.03); }
/* Main Area */
.main { flex: 1; padding: 30px; background: #f0fdfb; overflow-y: auto; animation: fadeIn 0.8s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
/* Header */
header { display:flex; justify-content:space-between; align-items:center; }
header h1 { color:#004d40; }
.user { display:flex; align-items:center; gap:10px; }
.avatar { width:35px; height:35px; background:#004d40; color:white; border-radius:50%; display:flex; justify-content:center; align-items:center; }
/* Cards */
.cards { display:flex; gap:20px; margin-top:30px; }
.card { flex:1; border-radius:10px; padding:20px; text-align:center; color:white; font-weight:600; box-shadow:0 4px 8px rgba(0,0,0,0.15); transition:transform 0.3s ease; }
.card:hover { transform: translateY(-5px); }
.card.active { background:#00796b; }
.card.resolved { background:#388e3c; }
.card.pending { background:#ffb300; }
/* Table */
.table-section { margin-top:40px; background:white; border-radius:10px; padding:20px; box-shadow:0 3px 6px rgba(0,0,0,0.1); }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { padding:10px; border-bottom:1px solid #ccc; text-align:left; font-size:14px; }
th { color:#004d40; }
.status { padding:4px 10px; border-radius:10px; color:white; font-size:13px; }
.status.pending { background:#ffb300; }
.status.resolved { background:#4caf50; }
.status.active { background:#4db6ac; }
img.photo { width:60px; height:60px; object-fit:cover; border-radius:5px; }
/* Scrollbar */
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-thumb { background:#80cbc4; border-radius:10px; }
</style>
</head>
<body>

<aside class="sidebar">
<h2>ðŸ§¹ CleanSweep Campus</h2>
<a href="/report"><button>ðŸ“¢ Report Issue</button></a>
<a href="/feedback"><button>ðŸ’¬ Feedback</button>
<a href="/logout"><button>ðŸšª Logout</button></a>
</aside>

<main class="main">
<header>
<h1>Dashboard</h1>
<div class="user">
<span class="avatar" id="avatar">A</span>
<span id="username">User</span>
</div>
</header>

<div class="cards">
<div class="card active" id="countActive">Active: 0</div>
<div class="card resolved" id="countResolved">Resolved: 0</div>
<div class="card pending" id="countPending">Pending: 0</div>
</div>

<section class="table-section">
<h3>Recent Complaints</h3>

<table>
<thead>
<tr>
<th>ID</th>
<th>Description</th>
<th>Status</th>
<th>Name of Student</th>
<th>Photo</th>
<th>Location</th>
<th>Updated</th>
</tr>
</thead>
<tbody id="complaintTable">
      {% for i in reports %}
      <tr>
      <td>{{i.pk}}</td>
      <td>{{i.description}}</td>
      <td>{{i.status}}</td>
      <td>{{i.name}}</td>
      <td>
        <a href="media/{{i.picture}}" style="text-decoration : none">check pitcure</a>
      </td>
      <td>Pune, Maharashtra</td>
      <td>17-Oct-2025 10:00 AM</td>
    </tr>
    {% endfor %}
    
</tbody>
</table>
</section>
</main>

<script>
// Logout
function logout(){ localStorage.removeItem('rememberedUser'); window.location.href='login.html'; }

// Load user info
window.onload = ()=>{
const user = JSON.parse(localStorage.getItem('rememberedUser'));
//if(!user){ window.location.href='login.html'; return; }
document.getElementById('username').innerText = user.username;
document.getElementById('avatar').innerText = user.username[0].toUpperCase();

loadComplaints();
}

// Load complaints from localStorage
function loadComplaints(){
const complaints = JSON.parse(localStorage.getItem('complaints')) || [];
const tbody = document.getElementById('complaintTable');
tbody.innerHTML='';

let countActive=0, countResolved=0, countPending=0;

complaints.reverse().forEach(c=>{
  const tr=document.createElement('tr');
  tr.innerHTML=`
    <td>${c.id}</td>
    <td>${c.description}</td>
    <td><span class="status ${c.status}">${c.status}</span></td>
    <td>${c.coordinator || '-'}</td>
    <td>${c.photo ? `<img class="photo" src="${c.photo}" alt="photo">` : '-'}</td>
    <td>${c.latitude && c.longitude ? c.latitude.toFixed(4)+', '+c.longitude.toFixed(4) : '-'}</td>
    <td>${c.updated}</td>
  `;
  tbody.appendChild(tr);

  if(c.status==='active') countActive++;
  else if(c.status==='resolved') countResolved++;
  else if(c.status==='pending') countPending++;
});

document.getElementById('countActive').innerText = 'Active: '+countActive;
document.getElementById('countResolved').innerText = 'Resolved: '+countResolved;
document.getElementById('countPending').innerText = 'Pending: '+countPending;
}
</script>

</body>
</html>


